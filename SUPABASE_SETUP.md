# Настройка Supabase

Для того чтобы сайт начал сохранять данные в облаке, выполните следующие шаги:

1. **Создайте проект** на [supabase.com](https://supabase.com).
2. Перейдите в **Settings -> API** и скопируйте:
   - `Project URL`
   - `anon public` key
3. Добавьте эти значения в `.env` файл вашего проекта (локально) и в переменные окружения Vercel:
   ```env
   NEXT_PUBLIC_SUPABASE_URL=ваша_ссылка
   NEXT_PUBLIC_SUPABASE_ANON_KEY=ваш_ключ
   ```

## 4. Создание Таблиц (SQL Editor)
В панели Supabase перейдите в **SQL Editor**, вставьте код ниже и нажмите **Run**:

```sql
-- 1. Таблица товаров
create table products (
  id uuid default gen_random_uuid() primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  name text not null,
  price numeric not null,
  category text not null,
  description text,
  image text, -- Ссылка на картинку
  is_merch boolean default false
);

-- 2. Таблица для Hero секции (хранит JSON)
create table site_settings (
  id int primary key generated by default as identity,
  key text unique not null,
  value jsonb not null
);

-- Вставим дефолтные данные для Hero
insert into site_settings (key, value)
values ('hero_data', '{
  "title": "Скульптура",
  "subtitle": "Света и Формы",
  "description": "Мы исследуем границы возможного...",
  "images": []
}'::jsonb);

-- 3. Включаем доступ (RLS) для чтения всем, записи только админам (пока откроем всем для простоты MVP)
alter table products enable row level security;
create policy "Public Read Products" on products for select using (true);
create policy "Public Insert Products" on products for insert with check (true);
create policy "Public Update Products" on products for update using (true);
create policy "Public Delete Products" on products for delete using (true);

alter table site_settings enable row level security;
create policy "Public Read Settings" on site_settings for select using (true);
create policy "Public Update Settings" on site_settings for update using (true);
```

## 5. Настройка Хранилища (Storage) для картинок
1. Перейдите в меню **Storage**.
2. Создайте новый бакет (New Bucket) с именем `images`.
3. Сделайте его **Public**.
4. Добавьте Policy (политику доступа):
   - Нажмите на бакет -> Policies -> New Policy -> "Give full access to everyone" (для MVP, чтобы админка работала без сложной авторизации).

Теперь админка будет загружать файлы в этот бакет, а сайт — читать данные из таблиц.



